//FOUINE FOUINE FOUINE FOUINE FOUINE FOUINE!
function getBodyWidth(){bodyWidth=document.body.offsetWidth;bodyWidth<=520?sizeScreen="mobile":bodyWidth<=1024?sizeScreen="tablette":sizeScreen="desktop";return sizeScreen}function changeImage(e,t){var n=getBodyWidth(),r=document.getElementById(t),i=r.getAttribute("src"),s=e.length+1,o=i.length;t=="indice-found"?newSrcImage=i.slice(0,7+s)+""+n+"-indice.svg":newSrcImage=i.slice(0,7+s)+""+n+".svg";r.setAttribute("src",newSrcImage)}function changeSVG(e){getBodyWidth();newSrcSVG="images/"+e+"-"+sizeScreen+".html";makeRequest(newSrcSVG);loadSVG++}function findIndice(){indice.addEventListener("touchend",function(){if(screen.className.length>12)if(screen.classList.contains("step-hidden-narration")){screen.classList.remove("step-hidden-narration");document.getElementById("narration").classList.remove("before")}else{screen.classList.remove("step-hidden-help");document.getElementById("help").classList.remove("before")}document.getElementById("bravo").style.display="block";indice.getAttribute("class")==""&&indice.setAttribute("class","shine");ctIndice=1;resetZoom(viewport);clearHandlers(root)})}function hideChapterBtn(){chapterBtn.classList.add("hidden");changeSVG(page);changeImage(page,id);ctChapter++;indice=document.getElementById("indice");screen.classList.add("step-hidden-narration");document.getElementById("narration").classList.add("before");getBodyWidth()=="mobile"&&(document.getElementById("narration-btn").innerHTML="<span>voir</span>");setTimeout(findIndice,1e3);closeIndice();togglePanel()}function togglePanel(){var e=Hammer(document.body,{drag:!1,swipe_velocity:.3});e.on("swipeleft",function(e){e.preventDefault();if(screen.classList[2]=="step-hidden-narration"){document.getElementById("narration").classList.remove("before");screen.classList.remove("step-hidden-narration");setupHandlers(root);getBodyWidth()=="mobile"&&(document.getElementById("narration-btn").innerHTML="<span>Lire</span>")}else if(screen.classList.length<3){document.getElementById("help").classList.add("before");screen.classList.add("step-hidden-help");clearHandlers(root);getBodyWidth()=="mobile"&&(document.getElementById("help-btn").innerHTML="<span>Voir</span>")}});e.on("swiperight",function(e){e.gesture.preventDefault();e.preventDefault();if(screen.classList[2]=="step-hidden-help"){document.getElementById("help").classList.remove("before");screen.classList.remove("step-hidden-help");setupHandlers(root);getBodyWidth()=="mobile"&&(document.getElementById("help-btn").innerHTML="<span>Besoin d'aide?</span>")}else if(screen.classList.length<3){document.getElementById("narration").classList.add("before");screen.classList.add("step-hidden-narration");clearHandlers(root);getBodyWidth()=="mobile"&&(document.getElementById("narration-btn").innerHTML="<span>Voir</span>")}})}function toggleDropdown(){var e=document.getElementById("help");[].forEach.call(e.getElementsByClassName("help-list"),function(e){e.addEventListener("touchend",function(){e.parentNode.getElementsByClassName("dropdown")[0].classList.toggle("dropdown-hidden");e.classList.toggle("active");e.getAttribute("id")=="help-indice"&&(indice.getAttribute("class")==""?indice.setAttribute("class","shine"):indice.setAttribute("class",""))})})}function closeIndice(){document.getElementById("close").addEventListener("touchend",function(e){e.preventDefault();document.getElementById("bravo").style.display="none"})}function checkInactivity(){function i(){if(screen.className.length<12){t.classList.remove("hidden");t.classList.add("open-right");n.classList.remove("hidden");n.classList.add("open-left")}else if(screen.classList.contains("step-hidden-narration")==1){n.classList.remove("hidden");n.classList.add("close-left")}else{t.classList.remove("hidden");t.classList.add("close-right")}[].forEach.call(document.getElementsByClassName("toggle"),function(e){e.classList.add("hover")});ctInactivity++}function s(){n.className="";n.classList.add("hidden");t.className="";t.classList.add("hidden");[].forEach.call(document.getElementsByClassName("toggle"),function(e){e.classList.remove("hover")})}function o(){s();clearTimeout(e);if(ctIndice==0)switch(ctInactivity){case 0:e=setTimeout(i,3e3);break;case 1:case 2:e=setTimeout(i,7e3);break;default:}}var e,t=document.getElementById("help-toggle-right"),n=document.getElementById("help-toggle-left"),r=Hammer(document.body);window.onload=o;r.on("tap, drag, swipe, touch",o)}function displayMobileTexte(){[].forEach.call(document.getElementsByClassName("texte"),function(e){e.classList.contains("tactile-only")==0?e.classList.add("hidden"):e.classList.remove("hidden")});if(document.body.getAttribute("id").slice(0,4)=="step"){document.getElementById("close").classList.add("hidden");document.body.getAttribute("id")=="step-4"&&document.getElementsByClassName("end")[0].classList.remove("hidden")}}function createUrl(){getBodyWidth();var e=window.location.pathname.split("?")[0],t=e+"?oldSizeScreen="+sizeScreen;return t}function sendUrl(e){var t=document.getElementById(e).elements,n="";url=document.getElementById(e).action;for(var r=0;r<t.length;r++){n+=t[r].name+"="+encodeURIComponent(t[r].value)+"&";if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest;xmlhttp.overrideMimeType&&xmlhttp.overrideMimeType("text/xml")}else if(window.ActiveXObject)try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){}}}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){if(xmlhttp.responseText=="send"){document.getElementById("fake-thanks").innerHTML="Voilà, tu peux partir tranquille";document.getElementById("email").value=""}}else{document.getElementById("fake-thanks").innerHTML="Remplis le champ mail (avec une adresse valide)";document.getElementById("email").value=""}};xmlhttp.open("POST",url,!1);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send(n);return xmlhttp.responseText}function makeRequest(e){var t=!1;if(window.XMLHttpRequest){t=new XMLHttpRequest;t.overrideMimeType&&t.overrideMimeType("text/xml")}else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}if(!t){alert("Abandon :( Impossible de créer une instance XMLHTTP");return!1}t.onreadystatechange=function(){injectContent(t)};t.open("GET",e,!0);t.send(null)}function injectContent(e){if(e.readyState==4&&e.status==200){svg.innerHTML=e.responseText;indice=document.getElementById("indice");root=document.getElementById("svgCanvas");viewport=root.getElementById("viewport");setTimeout(findIndice,1e3);resetZoom(viewport)}}function resetZoom(e){if(ctIndice>0){var t="matrix(1,0,0,1,0,0)";e.setAttribute("transform",t)}else e.addEventListener("dblclick",function(){var t="matrix(1,0,0,1,0,0)";e.setAttribute("transform",t)})}var chapterBtn=document.getElementsByClassName("chapter")[0],screen=document.getElementsByClassName("screen")[0],bodyWidth=document.body.offsetWidth,sizeScreen="mobile",root,state="none",svgRoot=null,stateTarget,stateOrigin,stateTf,loadSVG=0;ctIndice=0;displayMobileTexte();if(document.body.getAttribute("id")=="home"||document.body.getAttribute("id")=="rtfm"){var page=document.body.getAttribute("id"),id="illu",welcome=document.getElementById("welcome");changeImage(page,id);welcome.innerHTML==""?welcome.style.display="none":welcome.addEventListener("touchend",function(){this.style.display="none"});window.onresize=function(){return changeImage(page,id)}}if(document.body.getAttribute("id").slice(0,4)=="step"){var image=document.getElementById("illu"),svg=document.getElementsByClassName("illu")[0],page=document.body.getAttribute("id"),id="indice-found",url=document.getElementById("url"),welcome=document.getElementById("welcome"),ctChapter=0;if(welcome.innerHTML==""){welcome.style.display="none";setTimeout(hideChapterBtn,2e3)}else welcome.addEventListener("touchend",function(){this.style.display="none";setTimeout(hideChapterBtn,2e3)});chapterBtn.addEventListener("touchend",hideChapterBtn);url.setAttribute("value",createUrl());setTimeout(toggleDropdown,500);var ctInactivity=0;checkInactivity();document.getElementById("submit-quit").addEventListener("click",function(e){e.preventDefault()});document.getElementById("submit-quit").addEventListener("touchend",function(e){e.preventDefault();sendUrl("send-url")})};